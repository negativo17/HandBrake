--- HandBrake-0.9.9.old/libhb/muxmkv.c	2013-12-24 12:40:47.435079706 +0100
+++ HandBrake-0.9.9/libhb/muxmkv.c	2013-12-24 12:54:34.909411951 +0100
@@ -10,6 +10,11 @@
 /* libmkv header */
 #include "libmkv.h"
 
+#ifndef MK_SUBTITLE_PGS
+// stolen from upstream's A01-hbmv-pgs.patch
+#define MK_SUBTITLE_PGS    "S_HDMV/PGS"
+#endif
+
 #include <ogg/ogg.h>
 
 #include "hb.h"
@@ -294,8 +299,7 @@
         {
             // For HE-AAC, write outputSamplingFreq too
             // samplingFreq is half of outputSamplingFreq
-            track->extra.audio.outputSamplingFreq = (float)audio->config.out.samplerate;
-            track->extra.audio.samplingFreq = track->extra.audio.outputSamplingFreq / 2.;
+            track->extra.audio.samplingFreq = audio->config.out.samplerate / 2.;
         }
         else
         {
